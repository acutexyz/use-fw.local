<?php
	//TODO: pack "Controller" in config file
	class out
	{
		public $_params = array();
		
		public function writeTo($view_name, $label, $vars = array())
		{
			$this->checkView($view_name);
			$this->checkLabel($label);
			
			if($vars)
			{
				$this->_params[$view_name] = & $vars;
			}
			
			$this->_loaderLabels[$label] = "views/".url::getInstance()->getObjectName()."/".$view_name.".php";
		}
		
// 		private $_outBuffer = array();
// 		public function writeTo($label, $str)
// 		{
// 			$this->_outBuffer[$label] = & $str;
// 		}
		
		public function checkView($view_name)
		{
			$object_name = url::getInstance()->getObjectName();
			$view_path = "views/".$object_name."/".$view_name.".php";
			
			if(!file_exists($view_path))
				trigger_error("Could not find view file: ".$view_path);
			
			//return true;
		}
		
		private $_loaderLabels = array("content"=>"views/default.php");
		
		public function checkLabel($label)
		{
			if(!array_key_exists($label, $this->_loaderLabels))
				trigger_error("Label ".$label." is not defined");
		}
		
		public function loaderLabel($label)
		{
			$this->checkLabel($label);
			require_once($this->_loaderLabels[$label]);
			//echo $this->_outBuffer[$label];
		}
		
		private $_layout = "views/layout.php";
		
		public function render()
		{
			require_once($this->_layout);
		}
	}
?>
